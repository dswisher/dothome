
if [ -e .zshrc-local-pre ]; then
    source .zshrc-local-pre
fi

# Based on https://dougblack.io/words/zsh-vi-mode.html
# and http://zanshin.net/2013/02/02/zsh-configuration-from-the-ground-up/

# Set up history file
HISTFILE=~/.histfile
HISTSIZE=1000
SAVEHIST=1000

setopt hist_ignore_dups # Do not write events to history that are duplicates of previous events

# Set vi command-line editing mode
bindkey -v

# Have info use vi key bindings; an alias seems to be the only way
alias info='info --vi-keys'

# Enable highlighting in less
alias less='less -R'

#function zle-line-init zle-keymap-select {
#    VIM_PROMPT="%{$fg_bold[yellow]%} [% NORMAL]%  %{$reset_color%}"
#    # RPS1="${${KEYMAP/vicmd/$VIM_PROMPT}/(main|viins)/}$(git_custom_status) $EPS1"
#    RPS1="${${KEYMAP/vicmd/$VIM_PROMPT}/(main|viins)/} $EPS1"
#    zle reset-prompt
#}

#zle -N zle-line-init
#zle -N zle-keymap-select
#export KEYTIMEOUT=1

# clear LSCOLORS
unset LSCOLORS

# make directories more visible on a dark background
export CLICOLOR=1
export LSCOLORS=Gxfxcxdxbxegedabagacad

# use vim whenever possible
if [ -f /apollo/env/envImprovement/bin/vim ]; then
    export EDITOR=/apollo/env/envImprovement/bin/vim
elif [ -f /usr/local/bin/vim ]; then
    export EDITOR=/usr/local/bin/vim
else
    export EDITOR=/usr/bin/vim
fi
export VISUAL="$EDITOR"
export GIT_EDITOR="$EDITOR"

# make sure we use vim
alias vi=$EDITOR

# playing with GO; this is probably wrong...
if [ -d $HOME/GO ]; then
    export GOPATH=$HOME/GO
    export PATH="$PATH:/usr/local/go/bin:$GOPATH/bin"
fi

# my virtualenv wrapper
if [ -f $HOME/git/dothome/myvirtualenv.sh ]; then
    export VENV_DIR=~/VirtualEnvs
    source $HOME/git/dothome/myvirtualenv.sh
fi

# TODO - figure out this bit
# The following lines were added by compinstall
# zstyle :compinstall filename '$HOME/.zshrc'

# autoload -Uz compinit
# compinit
# End of lines added by compinstall

if [ -e .zshrc-local-post ]; then
    source .zshrc-local-post
fi

# Put local bin in path
export PATH="$PATH:$HOME/bin"

# pyenv support (if installed)
if [ -d $HOME/.pyenv ]; then
    export PYENV_ROOT="$HOME/.pyenv"
    export PATH="$PYENV_ROOT/bin:$PATH"

    eval "$(pyenv init -)"

    if [ -f $HOME/.pyenv/shims/virtualenv ]; then
        eval "$(pyenv virtualenv-init -)"
    fi
fi

# build tools
if [ -f /apollo/env/BrazilCLI/public-bin/brazil-build-tool-exec ]; then
    alias sam="brazil-build-tool-exec sam"
fi

# jenv support (if installed)
if [ -d $HOME/.jenv ]; then
    export PATH="$HOME/.jenv/bin:$PATH"
    eval "$(jenv init -)"
elif [ -d /usr/lib/jvm/java-8-openjdk-amd64 ]; then
    export JAVA_HOME="/usr/lib/jvm/java-8-openjdk-amd64"
fi

# Docker stuff
if [ -f /usr/bin/docker ]; then
    # TODO - not sure how portable this is
    export DOCKER_HOST=tcp://127.0.0.1:2376;
    export DOCKER_TLS_VERIFY=1
fi

# Experimental stuff
function up {
    if [[ "$#" < 1 ]] ; then
        cd ..
    else
        CDSTR=""
        for i in {1..$1} ; do
            CDSTR="../$CDSTR"
        done
        cd $CDSTR
    fi
}

# A few aliases
alias awsKiaraBD="aws-creds '306070047779' 'eu-west-1'"
alias awsKiaraGD="aws-creds '468125541434' 'eu-west-1'"
alias awsKiaraBI="aws-creds '082324551542' 'us-east-1'"
alias awsKiaraGI="aws-creds '777731679079' 'us-east-1'"
alias awsArch="aws-creds '092180355867' 'us-east-1'"
alias awsSwish="aws-creds '516009746567' 'us-east-1'"

