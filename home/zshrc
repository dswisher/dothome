
# Based on https://dougblack.io/words/zsh-vi-mode.html
# and http://zanshin.net/2013/02/02/zsh-configuration-from-the-ground-up/

# Set up history file
HISTFILE=~/.histfile
HISTSIZE=1000
SAVEHIST=1000

setopt hist_ignore_dups # Do not write events to history that are duplicates of previous events

# Set vi command-line editing mode
bindkey -v

# Have info use vi key bindings; an alias seems to be the only way
alias info='info --vi-keys'

# Enable highlighting in less
alias less='less -R'

#function zle-line-init zle-keymap-select {
#    VIM_PROMPT="%{$fg_bold[yellow]%} [% NORMAL]%  %{$reset_color%}"
#    # RPS1="${${KEYMAP/vicmd/$VIM_PROMPT}/(main|viins)/}$(git_custom_status) $EPS1"
#    RPS1="${${KEYMAP/vicmd/$VIM_PROMPT}/(main|viins)/} $EPS1"
#    zle reset-prompt
#}

#zle -N zle-line-init
#zle -N zle-keymap-select
#export KEYTIMEOUT=1

# clear LSCOLORS
unset LSCOLORS

# make directories more visible on a dark background
export CLICOLOR=1
export LSCOLORS=Gxfxcxdxbxegedabagacad

# use vim whenever possible
if [ -f /apollo/env/envImprovement/bin/vim ]; then
    export EDITOR=/apollo/env/envImprovement/bin/vim
elif [ -f /usr/local/bin/vim ]; then
    export EDITOR=/usr/local/bin/vim
else
    export EDITOR=/usr/bin/vim
fi
export VISUAL="$EDITOR"
export GIT_EDITOR="$EDITOR"

# make sure we use vim
alias vi=$EDITOR

# playing with GO; this is probably wrong...
if [ -d $HOME/GO ]; then
    export GOPATH=$HOME/GO
    export PATH="$PATH:/usr/local/go/bin:$GOPATH/bin"
fi

# my virtualenv wrapper
if [ -f $HOME/git/dothome/myvirtualenv.sh ]; then
    export VENV_DIR=~/VirtualEnvs
    source $HOME/git/dothome/myvirtualenv.sh
fi

# Put local bin in path
export PATH="$PATH:$HOME/bin"

# pyenv support (if installed)
if [ -d $HOME/.pyenv ]; then
    export PYENV_ROOT="$HOME/.pyenv"
    export PATH="$PYENV_ROOT/bin:$PATH"

    eval "$(pyenv init -)"

    if which pyenv-virtualenv-init > /dev/null; then
        eval "$(pyenv virtualenv-init -)";
    fi
fi

# jenv support (if installed)
# if [ -d $HOME/.jenv ]; then
#     export PATH="$HOME/.jenv/bin:$PATH"
#     eval "$(jenv init -)"
# elif [ -d /usr/lib/jvm/java-8-openjdk-amd64 ]; then
if [ -d /usr/lib/jvm/java-8-openjdk-amd64 ]; then
    export JAVA_HOME="/usr/lib/jvm/java-8-openjdk-amd64"
elif [ -f /System/Library/Frameworks/JavaVM.framework/Versions/Current/Commands/java ]; then
    export JAVA_HOME=$(/usr/libexec/java_home)
fi

# OpenCCG goofiness
if [ -d $HOME/git/openccg ]; then
    export OPENCCG_HOME=/Users/dsswishe/git/openccg
fi

# Docker stuff
if [ -f /usr/bin/docker ]; then
    # TODO - not sure how portable this is
    export DOCKER_HOST=tcp://127.0.0.1:2376;
    export DOCKER_TLS_VERIFY=1
fi

if [ -d $HOME/.nvm ]; then
    export NVM_DIR="$HOME/.nvm"
    [ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"  # This loads nvm
    # [ -s "$NVM_DIR/bash_completion" ] && \. "$NVM_DIR/bash_completion"  # This loads nvm bash_completion
fi

